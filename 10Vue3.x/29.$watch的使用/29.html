<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>$watch的方法</title>
</head>

<body>

    <div id="app">
        <input type="text" v-model="user.name">
        <br> {{user.name}}
        <hr>
        <input type="text" v-model="count">
        <br> {{count}}
    </div>

    <script src="../vue.global.js"></script>
    <script>
        // 创建一个应用实例，
        const app = Vue.createApp({
            data() {
                return {
                    user: {
                        name: 'Mr.Lee',
                        age: 100
                    },
                    count: 0,
                }
            },

            // 初始化
            created() {
                //1. $watch 实例方法和 watch 选项对象的作用功能是一样的，比如在初始化执行； 
                //PS：这里本身会返回一个取消侦听的函数； 
                this.$watch('count', (newValue, oldValue) => {
                    console.log('newCount ' + newValue);
                    console.log('oldCount ' + oldValue);
                });


                //2. 如果对于复杂的对象类型，需要使用箭头函数来表示需要监听的内容； 
                //PS：这里使用字符串形式无效，需要使用箭头函数的语法来声明； 
                //里面是两个箭头函数
                this.$watch(() => this.user.name, (newValue, oldValue) => {
                    console.log('newUserName ' + newValue);
                    console.log('oldUserName ' + oldValue);
                });


                //3. $watch 也支持深度监听的，支持关键字 deep 和 immediate 选项；
                this.$watch('user', (obj) => {
                    console.log(obj.age);
                }, {
                    deep: true,
                    immediate: true
                });
            }
        })

        // 这是一个根组件实例
        const vm = app.mount('#app');

        //外部也能使用
        // vm.$watch('count', (newValue, oldValue) => {
        //     console.log('newValue ' + newValue);
        //     console.log('oldValue ' + oldValue);
        // });
    </script>
</body>

</html>